# Machine-learning-drug-addiction-predictions
In this work, we evaluated and compared the performance of six machine learning algorithms: decision tree (DT) , logistic regression (LR) , artificial neural network (ANN) , naive Bayes, random forest (RF) and support vector machine (SVM) in predicting the risk of relapse of synthetic drugs. The experimental results showed that the RF model is better than the other five models, and its AUC, accuracy, precision, recall and F1-score are 0.95, 0.99, 0.98, 0.98 and 0.99 respectively. The risk prediction model established in this study makes up for the blank of machine learning algorithm in predicting the risk of relapse of synthetic drugs. It can provide a reliable basis for early detection of relapse tendency of drug addicts, and is of great significance to reduce the relapse rate and improve the effect of detoxification.This study recruited 1061 successfully detoxified synthetic drug abusers in 4 drug rehabilitation centers in Tianjin, China from July to August 2020, and was prospectively followed up for one year. The inclusion criteria were: (1) Age â‰¥ 18 years old; (2) Those who have taken synthetic drugs such as methamphetamine, amphetamine, and ecstasy before drug treatment; (3) Those with negative urine test results and were judged as successful detoxification by professional physicians; (4) Informed consent to this study, voluntary cooperate with investigators. The exclusion criteria were: (1) Participants with serious diseases such as heart, liver, kidney, and endocrine; (2) Participants with language comprehension and expression disabilities; (3) Cognitive impairment or a history of serious mental illness. A one-year follow-up survey was conducted on the included subjects, and their urine was tested every month. The personal information, drug abuse behavior, mental health status, social relations, and other data of the subjects were collected, and the questionnaires with missing follow-up and missing key variables were excluded. Finally, 893 participants were included. The number of synthetic drug relapsers were 755 (84.55%), and the number of synthetic drug non-relapsers were 138 (15.45%). 

## Prerequisites
The ensemble model was written in Python scripting language (Version 3.6.5, Python Software Foundation, Wilmington, DE, USA, https://www.python.org). Different packages such as NumPy, pandas, scikit, and Matplotlib have been used in analyzing the data. We implemented 6 algorithms using the Scikit-learn library in the Python programming environment. 

## Data distribution
<img src="https://github.com/XUEXI-CL/Machine-learning-drug-addiction-predictions/blob/main/images/Data%20distribution.png" width="600" height="600">

<img src="https://github.com/XUEXI-CL/Machine-learning-drug-addiction-predictions/blob/main/images/Confusion%20matrix%20figure.png" width="600" height="600">

## The test set was used to fit the model and generate the final results. 
<img src="https://github.com/XUEXI-CL/Machine-learning-drug-addiction-predictions/blob/main/images/Models%20test_ROC.png" width="600" height="600">
